<?xml version="1.0" encoding="UTF-8"?>
<!--
Allows a manager to approve or unapprove
Reviews that have not be seen by the manager yet will have a status of pending and will change to reviewed status once manager approves or disapproves

@author Shruti Pareek
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:bookstore="http://java.sun.com/jsf/composite/default_components"
      xmlns:p="http://primefaces.org/ui"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:head>

        <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&amp;display=swap" rel="stylesheet"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <h:outputStylesheet library="webjars" name="Semantic-UI/2.4.1/semantic.min.css" />
        <h:outputStylesheet library="webjars" name="swiper/4.5.1/dist/css/swiper.min.css" />
        <h:outputScript library="webjars" name="Semantic-UI/2.4.1/semantic.min.js"/>
        
        <title>Manage Reviews</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    </h:head>
    <h:body>
        <!--Table of customer reviews-->
        <h:form id="reviewTable">
            <h:dataTable  var="reviews" style="margin-bottom: 20px;"  class="ui celled table" value="#{customerReviewsJpaController.findCustomerReviewsEntities()}" >
                <h:column>
                    <f:facet name="header">Review ID</f:facet>
                        #{reviews.reviewID}
                </h:column>
                <h:column>
                    <f:facet name="header">Client Email</f:facet>
                       #{clientsJpaController.findClients(reviews.clientID).email}
                </h:column>
                <h:column>
                    <f:facet name="header">Book</f:facet>
                    <ui:repeat var="book" value="#{bookJpaController.findBookAll(reviews.isbn)}">
                        #{book.title}
                    </ui:repeat>
                </h:column>
                <h:column>
                    <f:facet name="header">Rating</f:facet>
                    #{reviews.rating}/5
                </h:column>
                <h:column>
                    <f:facet name="header">Review Title</f:facet>
                        #{reviews.reviewTitle}
                </h:column>
                <h:column>
                    <f:facet name="header">Review Body</f:facet>
                        #{reviews.reviewBody}
                </h:column>
                <h:column>
                    <f:facet name="header">Last Modified</f:facet>
                        #{reviews.lastModified}
                </h:column>
                <h:column>
                    <f:facet name="header">Date Created</f:facet>
                        #{reviews.dateEntered}
                </h:column>
                <h:column>
                    <f:facet name="header">Date Removed</f:facet>
                        #{reviews.dateRemoved}
                </h:column>
                <h:column>
                    <f:facet name="header">Status</f:facet>
                        #{reviewManagmentBean.getPendingStatus(reviews.pending)}
                </h:column>
                <h:column>
                    <h:commandButton type="button" action="#{reviewManagmentBean.manageApproval(reviews.isRemoved, reviews.reviewID , reviews.pending)}" value="#{reviewManagmentBean.getRemovalStatus(reviews.isRemoved)}" class="big ui primary button edit_btn">
                         <f:ajax execute="@form" render="reviewTable" />
                    </h:commandButton>
                </h:column>
            </h:dataTable>
        </h:form>
    </h:body>
</html>
