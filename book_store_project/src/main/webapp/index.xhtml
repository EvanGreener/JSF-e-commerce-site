<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"

      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:bookstore="http://java.sun.com/jsf/composite/default_components"
      xmlns:p="http://primefaces.org/ui"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough">
    <h:head>

        <title>The BookStore</title>
        <link rel="stylesheet" href="https://unpkg.com/swiper/css/swiper.min.css"/>

        <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&amp;display=swap" rel="stylesheet"/>

        <h:outputStylesheet library="webjars" name="Semantic-UI/2.4.1/semantic.min.css" />
        <h:outputStylesheet library="css" name="homepage.css" />

        <h:outputScript library="js" name="homepage.js" />

        <script  src="https://www.gstatic.com/charts/loader.js"></script>
        <script src="https://unpkg.com/swiper/js/swiper.min.js"></script>
    </h:head>

    <h:body>

        <!--<b:alert severity="info">{clientBacking.message}</b:alert>-->


        <!--composite component that comes from the navbar.xhtml file to avoid coding nav bar in all web pages-->
        <bookstore:navbar/>

        <!--Carousel that displays recently added books and their information-->
        <div class="swiper-container">
            <div class="swiper-wrapper">
                <ui:repeat value="#{bb.recentlyAdded}" var="book">
                    <div class="swiper-slide item#{bb.bookSlideColor}">
                        <div class="sliderTextContent">
                            <h1>#{book.title}</h1>
                            <span>    <ui:repeat value="#{book.authorsCollection}" var="author">
                                    #{author.name}
                                </ui:repeat></span>
                            <p> #{book.description}</p>
                            <!--Button directs you to the book page for the current book being displayed in the carousel-->
                            <h:form>
                                <h:commandButton type="submit" value="Shop Now" action="#{bb.viewBook(book)}" />
                            </h:form>
                        </div>
                        <div  class="sliderImageContent">
                            <h:graphicImage width="300px" height="400px" library="images" name="#{book.isbn}.jpg"  />
                        </div>
                    </div>
                </ui:repeat>
            </div>

            <!-- Add Pagination -->
            <div class="swiper-pagination"></div>
            <!-- Add Arrows -->
            <div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>
        </div>
        <div class="lightOrangeDiv">

            <!--Shows top eight books with that have been purchased most-->
            <p class="small">Best Seller Products</p><br/>
            <h:form>
                <h:panelGroup>
                    <div class="ui four doubling stackable cards">


                        <ui:repeat value="#{bb.bestSeller}" var="books">

                            <div class="ui fluid card darker homepageCard">
                                <div class="homepageImg">
                                    <h:graphicImage class="img" height="250" width="200" library="images" name="#{books.isbn}.jpg"/>
                                    <div class="cardHoverBtn"> View Cover</div>
                                </div>

                                <div class="content">

                                    <h:commandLink action = "#{bb.viewBook(books)}" type="submit" value = "">
                                        <div class="header textColor">

                                            #{books.title}</div>
                                        <div class="meta">

                                            <ui:repeat value="#{books.authorsCollection}" var="author">
                                                #{author.name}
                                            </ui:repeat>

                                        </div>

                                        <div class="description">
                                            <div class="ui tag labels">
                                                <a class="ui label">
                                                    $#{books.listPrice}
                                                </a>
                                            </div>

                                        </div>
                                    </h:commandLink>

                                </div>

                                <!--Button to add to shopping cart-->
                                <div class="ui two bottom attached buttons ">
                                    <div onclick="addToCart(#{books.isbn}, 'pdf')" class="ui button">+ Add to Cart</div>



                                </div>
                            </div>
                        </ui:repeat>
                    </div>
                </h:panelGroup>
            </h:form>

            <br/><br/>

            <!--Search bar used searching for books that will display results in gallery page-->
            <h:form>
                <div class=" searchBarDiv">
                    <h:inputText a:placeholder="Search books..." value="#{search.query}" style=" float: center; margin-top: -30px;" class="searchBar"/>
                    <h:commandButton class="searchButton" action="#{search.showSearch()}" type="submit" value = "Search"/>
                </div>
            </h:form>


            <!-- The Modal -->
            <div id="myModal" class="modal">

                <!-- The Close Button -->
                <span class="close">x</span>

                <!-- Modal Content (The Image) -->
                <h:graphicImage height="100%" width="50%" class="modal-content" id="img01" library="images" name="colorScheme.PNG"  />

                <!-- Modal Caption (Image Text) -->
                <div id="caption"></div>
            </div>

        </div>


        <!-- Survey/Ad/News Section -->

        <div   class="lightGreyDiv">
            <table class="ui table lightGreyDiv" >

                <!-- Shows the News -->
                <tbody>
                    <tr align="center">
                        <td align="center">
                            <div style="background-color:#d77a61;" class="ui half page test ad left" data-text="">
                                <h3 style="color:white;padding-top: 10px;" >News</h3>
                                <p:scrollPanel style="overflow-y: auto;height: 100%;">
                                
                                    <p:feedReader size="10" value="#{newsBean.randomNews.RSSFeed}" var="feed">
                                        <h:outputText value="#{feed.title}" style="font-weight: bold"/>
                                        <h:outputText value="#{feed.description.value}" escape="false"/>
                                        <p:separator />
                                        <f:facet name="error">
                                            Something went wrong.
                                        </f:facet>
                                    </p:feedReader>  
                                                   
                                </p:scrollPanel>

                            </div></td>
                        <td align="center"> <div id="surveyDiv" class="ui netboard test ad survey" data-text="" >

                                <!-- Survey Section -->
                                <h:form >
                                    <p>#{ss.setSurvey()}</p>
                                    <ui:repeat value="#{ss.survey}" var="s">
                                        <h1 id="surveyStatus" style="text-align:center">  #{s.surveyName}</h1>
                                        <!-- Shows the survey results once survey completed-->
                                        <p id="surveyId" class="invisible">#{s.surveyID}</p>
                                        <div id="results" class="invisible">
                                       
                                            <hr/>
                                            <p:chart id="barchart" type="bar"  model="#{surveyDataBacking.getBarChart(s.surveyID)}"  style="width:530px"/>
                                            <div class="ui horizontal statistics">
                                                <h:panelGroup id="other" >
                                                    <ui:repeat  value="#{surveyDataBacking.getSurveyChoices(s.surveyID)}" var="sd">
                                                        <div class="ui statistic">
                                                            <div class="value">#{sd.votes}</div>
                                                            <div class="label">#{sd.choice}</div>
                                                        </div>
                                                        <br/>
                                                    </ui:repeat>
                                                </h:panelGroup>
                                            </div>
                                            <hr/>
                                            <h2>Thank you for answering!</h2>
                                        </div>


                                        <!-- Shows the actual survey-->
                                        <div id="survey">
                                            <p style="font-size:20px;padding:2%">#{s.surveyDescription}</p>

                                            <p:selectOneRadio style="font-size:20px" required="true" layout="pageDirection" value="#{surveyDataBacking.surveyDataChoice}" >
                                                <f:selectItems value="#{s.surveyData}" var="sd" itemValue="#{sd.dataID}" itemLabel = " #{sd.choice}" />
                                            </p:selectOneRadio>
                           
                                            <p:commandButton  update="other barchart" class="bookFormatBtn"  value="Submit" oncomplete="showResults(#{s.surveyID})"/>

                                        </div>
                                    </ui:repeat>
                                </h:form>
                            </div></td>

                        
                        
               
                        
                        
                        <!-- First Ad location -->
                        <td align="center"><div class="ui wide skyscraper test ad right homepageCard" data-text="">
                                <ui:repeat value="#{adsBean.randomAd}" var="ad">
                                    <h:graphicImage height="100%" width="100%" library="images" name="#{ad.imageName}1.png"  onclick="viewAd('#{ad.adUrl}')"/>
                                </ui:repeat>
                            </div></td>
                    </tr>
                </tbody>
            </table>

        </div>

        <!-- Shows the most popular book genres -->
        <div class="lightPurpleDiv">
            <p class="small">Popular Genres</p><br/>
            <h:form>
                <h:panelGroup>
                    <div class="ui four doubling stackable cards">
                        <ui:repeat value="#{bb.popularGenres}" var="genres">
                            <div class="ui fluid card darker">
                                <h:commandLink action = "#{search.showGenreBooks(genres)}" type="submit" value = "">
                                    <div class="homepageImg">
                                        <h:graphicImage class="img" height="200" width="320" library="images" name="#{genres}.jpg"/>
                                    </div>
                                    <div class="content">
                                        <div class="header"><h3 class="genre">#{genres}</h3></div>
                                    </div>
                                </h:commandLink>
                            </div>
                        </ui:repeat>
                    </div>
                </h:panelGroup>
            </h:form>
            <br/><br/>

            <!-- Second Ad location -->
            <div class="ui centered leaderboard test ad" data-text="">
                <ui:repeat value="#{adsBean.randomAd}" var="ad">
                    <h:graphicImage height="100%" width="100%" library="images" name="#{ad.imageName}2.png" onclick="viewAd('#{ad.adUrl}')" />
                </ui:repeat>
            </div>
        </div>
        
        <div class='lightGreyDivLessSpacing'>
          <div class="ui top attached tabular menu" id="tabs">
              <a class="active item" data-tab="hello">Welcome</a>
              <a class="item" data-tab="featured">Featured Books</a>
              <a class="item" data-tab="best">Best Sellers</a>
              <a class="item" data-tab="news">News Feeds</a>
              <a class="item" data-tab="ads">Advertisements</a>
              <a class="item" data-tab="surveys">Surveys</a>
              <a class="item" data-tab="genres">Book Genres</a>
          </div>
          <div class="ui bottom attached active tab segment" data-tab="hello">
              Welcome to TheBooksStore. We hope you enjoy your experience. Help sections can
              be found near the bottom of every page, atop the footer. So in case you are
              wondering how a certain page works or what there is to do, don't hesitate to scroll
              near the bottom and refer to the help sections so you can make the most of your
              experience!
          </div>
          <div class="ui bottom attached tab segment" data-tab="featured">
              A carousel of featured books will be displayed on top of the page, right below the
              navigation bar. Rotation is automatic, but clicking the arrows on either side will
              display the next or previous book in the carousel. Clicking "Shop Now" below a book 
              will redirect you to its information page, where you can read a plot summary, add it 
              to your cart, and, for registered users only, leave a review.
          </div>
          <div class="ui bottom attached tab segment" data-tab="best">
              The best selling books as of the time the user accesses the page will be displayed
              below the carousel of featured books. You can click on the titles of these books
              to access their respective information pages, where you can read a plot summary,
              add them to your cart, and, for registered users only, leave a review. You can also
              search for books by title directly on the index page, using the search bar below the
              best selling books, in which case clicking "Search" will redirect you to the gallery 
              page with the search query intact.
          </div>
          <div class="ui bottom attached tab segment" data-tab="news">
              A randomly selected news feed will be displayed on the home page every time you access
              it. You may click on certain interactive links to access relevant pages as you would
              on the actual site where the news originates from, or you even have the option of reading
              the article on said origin site by clicking "Read article ...".
          </div>
          <div class="ui bottom attached tab segment" data-tab="ads">
              Two randomly selected ads will be displayed on the home page every time you access it.
              Clicking on these ads will redirect the user to another page centered around the object
              or service which they are advertising.
          </div>
          <div class="ui bottom attached tab segment" data-tab="surveys">
              The user has the option of participating in a randomly generated survey every time they
              access the home page. Upon selecting an option, their choice will be accounted for and
              the total number of people who selected each choice will be displayed. If the user wishes
              to participate in another survey, they must refresh the page.
          </div>
          <div class="ui bottom attached tab segment" data-tab="genres">
              To view all books of a certain genre, click on one of the 4 genre selectors near the bottom
              of the page, just above the bottommost ad. There are 4 book genres to choose from: Mystery,
              Horror, Science Fiction, and Fantasy. Clicking on either of these selectors will redirect
              the user to the gallery page with a search query for said genre intact, and they will be
              able to view all books of their requested genre.
          </div>
        </div>

        <!--composite component that comes from the footer.xhtml file to avoid coding the website footer in all web pages-->
        <bookstore:footer/>

        <!-- Initialize Swiper -->
        <script>
            var swiper = new Swiper('.swiper-container', {
                loop: true,
                centeredSlides: true,
                autoplay: {
                    delay: 5000,
                    disableOnInteraction: false,
                },
                pagination: {
                    el: '.swiper-pagination',
                },
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
            });
        </script>
    </h:body>
</html>
