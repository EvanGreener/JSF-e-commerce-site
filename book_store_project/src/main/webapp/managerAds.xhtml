<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:bookstore="http://java.sun.com/jsf/composite/default_components"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough">
    <h:head>
        <title>Manager Ads</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

        <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&amp;display=swap" rel="stylesheet"/>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <h:outputStylesheet library="webjars" name="Semantic-UI/2.4.1/semantic.min.css" />
        <h:outputStylesheet library="webjars" name="swiper/4.5.1/dist/css/swiper.min.css" />
        <h:outputStylesheet library="temp" name="homepage.css" />
        <h:outputScript library="webjars" name="Semantic-UI/2.4.1/semantic.min.js"/>
    </h:head>

    <h:body>

        <h:form id="editForm">
            <bookstore:navbar />

            <div class="middle">

                <div id="editFormGrowl" class="ui floating positive message" >
                    <!--<i class="close icon"></i>-->
                    <div class="header">
                        Changes have been saved!
                    </div>
                </div>

                <h1 class="ui header">Ad Management</h1>


                <h:commandButton value="Add Ad" class="big pink ui button" onclick="setTimeout(function () {
                            $('#addModal').modal('show', hideGrowl())
                        }, 500)">
                    <f:ajax event="click" render="editForm" listener="#{adBacking.onCreate()}"/>
                </h:commandButton>


                <h:dataTable id="adsTable" var="ads" style="margin-bottom: 20px;" class="ui celled table" value="#{adsJpaController.findAdsEntities()}">
                    <h:column>
                        <f:facet name="header">Ad #</f:facet>
                            #{ads.adID}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Ad URL</f:facet>
                            #{ads.adUrl}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Ad Image</f:facet>
                            #{ads.imageName}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Date Created</f:facet>
                            #{ads.dateCreated}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Last Modified</f:facet>
                            #{ads.lastModified}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Status</f:facet>
                            #{adsJpaController.getStatusByAdId(ads.adID)}
                    </h:column>
                    <h:column>
                        <h:commandLink value="#{adBacking.getRemovalStatus(ads.isRemoved)}" disabled="#{adBacking.decideDisabled(ads)}">
                            <f:ajax event="click" listener="#{adBacking.addOrRemoveAd(ads)}" />
                        </h:commandLink>
                    </h:column>
                    <h:column>
                        <h:commandButton type="button" value="Edit Ad" disabled="#{ads.isRemoved}" onclick="setTimeout(function () {
                            $('#editModal').modal('show', hideGrowl())}, 500)" class="big ui primary button edit_btn" >
                             <f:ajax event="click" render="@all" listener="#{editAd.onEdit(ads.adID)}" />
                        </h:commandButton>
                    </h:column>
                </h:dataTable>
            </div>

            <bookstore:footer />
        </h:form>
        <div id="addModal" class="small ui modal">
            <div class="header">
                <h1>Add Ad</h1>
            </div>
            <div class="content">
                <h:form id="addForm">
                    <div class="ui form field">
                        <h:outputLabel for="adUrl" value="Ad URL"/>
                        <h:inputText id="adUrl" label="Ad URL" value="#{adBacking.ad.adUrl}" required="true" requiredMessage="Please enter ad URL" a:placeholder="Enter ad URL" validator="#{adBacking.validateNotNull}">
                            <f:ajax event="change" render="adUrlError"/>
                        </h:inputText>
                        <br/>
                        <h:message id="adUrlError" class="error" for="adUrl"/>
                    </div>
                    <br/>
                    <div class="ui form field">
                        <h:outputLabel for="imageName" value="Image Name"/>
                        <h:inputText id="imageName" label="Image Name" value="#{adBacking.ad.imageName}" required="true" requiredMessage="Please enter image name" a:placeholder="Enter image name" validator="#{adBacking.validateNotNull}">
                            <f:ajax event="change" render="imageNameError"/>
                        </h:inputText>
                        <br/>
                        <h:message id="imageNameError" class="error" for="imageName"/>
                    </div>
                    <br/>
                    <h:commandButton type="button" class="huge black fluid ui button" id="createAd" value="Create Ad" action="#{adBacking.createAd()}">
                        <f:ajax event="click" execute="adUrl imageName" render="editForm"/>
                    </h:commandButton>
                </h:form>
            </div>
        </div>

        <div id="editModal" class="small ui modal">
            <div class="header">
                <h1>Edit Ad</h1>
            </div>
            <div class="content">
                <h:form id="editAdForm">
                    <div class="ui form field">
                        <h:outputLabel for="newAdUrl" value="Ad URL"/>
                        <h:inputText id="newAdUrl" label="Ad URL" value="#{editAd.newUrl}" required="true" requiredMessage="Please enter ad URL" a:placeholder="Enter ad URL" validator="#{adBacking.validateNotNull}">
                            <f:ajax event="change" render="newAdUrlError"/>
                        </h:inputText>
                        <br/>
                        <h:message id="newAdUrlError" class="error" for="newAdUrl"/>
                    </div>
                    <br/>
                    <div class="ui form field">
                        <h:outputLabel for="newAdImageName" value="Image Name"/>
                        <h:inputText id="newAdImageName" label="Image Name" value="#{editAd.newImage}" required="true" requiredMessage="Please enter image name" a:placeholder="Enter image name" validator="#{adBacking.validateNotNull}">
                            <f:ajax event="change" render="newAdImageNameError"/>
                        </h:inputText>
                        <br/>
                        <h:message id="newAdImageNameError" class="error" for="newAdImageName"/>
                    </div>
                    <br/>
                    <h:commandButton type="button" class="huge black fluid ui button" id="editAd" value="Edit Ad" action="#{editAd.onSubmitEdit()}">
                        <f:ajax event="click" execute="adUrl imageName" render="editForm"/>
                    </h:commandButton>
                </h:form>
            </div>
        </div>


        <script>
            function hideGrowl() {
                $('#editFormGrowl').hide('slow');
            }

        </script>

    </h:body>
</html>
