<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:bookstore="http://java.sun.com/jsf/composite/default_components"
      xmlns:p="http://primefaces.org/ui"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough">
    <h:head>
        <title>Manager Orders</title>
          <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

          <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&amp;display=swap" rel="stylesheet"/>
          <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
          <h:outputStylesheet library="webjars" name="Semantic-UI/2.4.1/semantic.min.css" />
          <h:outputStylesheet library="webjars" name="swiper/4.5.1/dist/css/swiper.min.css" />
          <h:outputStylesheet library="css" name="homepage.css" />
          <h:outputScript library="webjars" name="Semantic-UI/2.4.1/semantic.min.js"/>
          <style>

               .modal{
                    position: fixed;
                    padding-top: 0px;
                    height: fit-content;
                    text-align: center;
                    text-size: 18px;
               }

               .middle h1 {
                    margin-top: 20px !important;
                    text-align: center;
                    color: gray;
               }
               .middle{
                    padding: 0px 40px 0px 40px;
               }
               
               .actions{
                    height: 80%;
                    text-align: center !important;
                    font-size: 20px;
                    margin: 10px 10px 10px 10px;
               }
               
               .actions .ui.button {
                    margin: 10px 10px 10px 10px;
               }
               
               .footer button{
                    font-size: 20px !important;
                    margin: 0px 10px 0px 10px !important;
               }

               .header h1 {
                    text-align: center !important;
               }

/*               .content h3 {
                    
               }*/

               .form-field{
                    font-size: 18px;
                    margin: 10px 0px 10px 5px;

               }

               #editFormGrowl{
                    position: fixed;
                    display: none;
                    z-index: 777;
                    left: 100%;
                    margin-left: -257.42px;
                   

               }

          </style>
    </h:head>

     <h:body>

          <h:form id="editForm">
               <bookstore:navbar />

               <div class="middle">

                    <div id="editFormGrowl" class="ui floating positive message" >
                         <!--<i class="close icon"></i>-->
                         <div class="header">
                              Changes have been saved!
                         </div>
                    </div>
                    
                    <h1>Ad Management</h1>

                    <!--Search bar: UPDATE FOR ORDERS-->
                    <div style="display: inline;" class="ui search" >
                         <h:inputText  id="query" value="#{clientManagement.query}"  a:placeholder="Search orders by email..." style="float: right; margin-top: 10px; margin-bottom: 10px; width: 200px; " class="prompt" >
                              <p:ajax event="keyup" listener="#{clientManagement.updateBean()}" update="adsTable" />
                         </h:inputText>
                    </div> 



                <h:commandButton type="button" value="Add Ad" class="big pink ui button" onclick="setTimeout(function () {
                            $('#addModal').modal('show', hideGrowl())
                        }, 500)" />

                <h:dataTable id="adsTable" class="ui celled table" value="#{adsJpaController.findAdsEntities()}" var="ads">
                    <h:column>
                        <f:facet name="header">Ad #</f:facet>
                            #{ads.adID}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Ad URL</f:facet>
                            #{ads.adUrl}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Ad Image</f:facet>
                            #{ads.imageName}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Date Created</f:facet>
                            #{ads.dateCreated}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Last Modified</f:facet>
                            #{ads.lastModified}
                    </h:column>
                    <h:column>
                        <f:facet name="header">Status</f:facet>
                            #{adsJpaController.getStatusByAdId(ads.adID)}
                    </h:column>
                    <h:column>
                        <h:commandLink value="#{adBacking.getRemovalStatus(ads.isRemoved)}" action="#{adBacking.addOrRemoveAd(ads)}"/> 
                    </h:column>
                </h:dataTable>
               </div>

               <bookstore:footer />
               
               <div id="addModal" class="small ui modal">
                    <div class="header">
                        <h1>Add Order</h1>
                    </div>
                   <div class="content">
                      <div class="ui form field">
                        <h:outputLabel for="adUrl" value="Ad URL"/>
                        <h:inputText id="adUrl" label="Ad URL" value="#{adBacking.ad.adUrl}" required="true" requiredMessage="Please enter ad URL" a:placeholder="Enter ad URL" validator="#{adBacking.validateNotNull}">
                            <f:ajax event="change" render="adUrlError"/>
                        </h:inputText>
                        <br/>
                        <h:message id="adUrlError" class="error" for="adUrl"/>
                    </div>
                    <div class="ui form field">
                        <h:outputLabel for="imageName" value="Image Name"/>
                        <h:inputText id="imageName" label="Image Name" value="#{adBacking.ad.imageName}" required="true" requiredMessage="Please enter image name" a:placeholder="Enter image name" validator="#{adBacking.validateNotNull}">
                            <f:ajax event="change" render="imageNameError"/>
                        </h:inputText>
                        <br/>
                        <h:message id="imageNameError" class="error" for="imageName"/>
                    </div>
                    <h:commandButton type="button" class="huge black fluid ui button" id="createAd" value="Create Ad" action="#{adBacking.createAd()}" />

                   </div>
               </div>

          </h:form>

          <script>
               function hideGrowl() {
                    $('#editFormGrowl').hide('slow');
               }
               
          </script>

     </h:body>
</html>
